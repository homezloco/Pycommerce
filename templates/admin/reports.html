{% extends 'admin/base_admin.html' %}

{% block dashboard_title %}Reports{% endblock %}

{% block dashboard_content %}
<div class="row">
    <div class="col-12">
        <div class="card mb-4">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0">Business Reports</h5>
                <div>
                    <button class="btn btn-sm btn-outline-secondary me-2">
                        <i class="bi bi-download"></i> Export
                    </button>
                    <button class="btn btn-sm btn-outline-secondary">
                        <i class="bi bi-printer"></i> Print
                    </button>
                </div>
            </div>
            <div class="card-body">
                <ul class="nav nav-tabs" id="reportsTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="sales-tab" data-bs-toggle="tab" data-bs-target="#sales" type="button" role="tab" aria-controls="sales" aria-selected="true">
                            <i class="bi bi-graph-up"></i> Sales
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="products-tab" data-bs-toggle="tab" data-bs-target="#products" type="button" role="tab" aria-controls="products" aria-selected="false">
                            <i class="bi bi-box"></i> Products
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="customers-tab" data-bs-toggle="tab" data-bs-target="#customers" type="button" role="tab" aria-controls="customers" aria-selected="false">
                            <i class="bi bi-people"></i> Customers
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="taxes-tab" data-bs-toggle="tab" data-bs-target="#taxes" type="button" role="tab" aria-controls="taxes" aria-selected="false">
                            <i class="bi bi-receipt"></i> Taxes
                        </button>
                    </li>
                </ul>

                <div class="tab-content p-3 border border-top-0 rounded-bottom" id="reportsTabContent">
                    <!-- Sales Reports Tab -->
                    <div class="tab-pane fade show active" id="sales" role="tabpanel" aria-labelledby="sales-tab">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <div class="input-group">
                                    <span class="input-group-text">Date Range</span>
                                    <input type="date" class="form-control" value="2025-03-01">
                                    <span class="input-group-text">to</span>
                                    <input type="date" class="form-control" value="2025-04-01">
                                    <button class="btn btn-primary" type="button">Apply</button>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <select class="form-select">
                                    <option>Daily</option>
                                    <option selected>Weekly</option>
                                    <option>Monthly</option>
                                    <option>Quarterly</option>
                                    <option>Yearly</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <select class="form-select">
                                    <option selected>All Payment Methods</option>
                                    <option>Credit Card</option>
                                    <option>PayPal</option>
                                    <option>Stripe</option>
                                </select>
                            </div>
                        </div>

                        <div class="row mb-4">
                            <div class="col-md-3">
                                <div class="card bg-primary text-white">
                                    <div class="card-body">
                                        <h6 class="card-title">Total Sales</h6>
                                        <h3 class="card-text">$24,582.50</h3>
                                        <small class="text-white-50">+15.8% from previous period</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card bg-success text-white">
                                    <div class="card-body">
                                        <h6 class="card-title">Orders</h6>
                                        <h3 class="card-text">245</h3>
                                        <small class="text-white-50">+8.3% from previous period</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card bg-info text-white">
                                    <div class="card-body">
                                        <h6 class="card-title">Average Order Value</h6>
                                        <h3 class="card-text">$100.34</h3>
                                        <small class="text-white-50">+6.9% from previous period</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card bg-warning text-white">
                                    <div class="card-body">
                                        <h6 class="card-title">Conversion Rate</h6>
                                        <h3 class="card-text">3.2%</h3>
                                        <small class="text-white-50">+0.5% from previous period</small>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card mb-4">
                            <div class="card-header">
                                <h6 class="mb-0">Sales Trend</h6>
                            </div>
                            <div class="card-body">
                                <canvas id="salesChart" height="100"></canvas>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="card mb-4">
                                    <div class="card-header">
                                        <h6 class="mb-0">Sales by Payment Method</h6>
                                    </div>
                                    <div class="card-body">
                                        <canvas id="paymentMethodChart" height="200"></canvas>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card mb-4">
                                    <div class="card-header">
                                        <h6 class="mb-0">Sales by Category</h6>
                                    </div>
                                    <div class="card-body">
                                        <canvas id="categorySalesChart" height="200"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Products Reports Tab -->
                    <div class="tab-pane fade" id="products" role="tabpanel" aria-labelledby="products-tab">
                        <div class="row mb-3">
                            <div class="col-md-9">
                                <div class="input-group">
                                    <span class="input-group-text">Date Range</span>
                                    <input type="date" class="form-control" value="2025-03-01">
                                    <span class="input-group-text">to</span>
                                    <input type="date" class="form-control" value="2025-04-01">
                                    <button class="btn btn-primary" type="button">Apply</button>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <select class="form-select">
                                    <option selected>All Categories</option>
                                    <option>Electronics</option>
                                    <option>Clothing</option>
                                    <option>Home & Garden</option>
                                </select>
                            </div>
                        </div>

                        <div class="card mb-4">
                            <div class="card-header">
                                <h6 class="mb-0">Top Selling Products</h6>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-striped table-hover">
                                        <thead>
                                            <tr>
                                                <th>Product</th>
                                                <th>Category</th>
                                                <th>Units Sold</th>
                                                <th>Revenue</th>
                                                <th>Avg. Price</th>
                                                <th>Stock</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>Wireless Headphones</td>
                                                <td>Electronics</td>
                                                <td>87</td>
                                                <td>$4,342.65</td>
                                                <td>$49.91</td>
                                                <td>124</td>
                                            </tr>
                                            <tr>
                                                <td>Stainless Steel Water Bottle</td>
                                                <td>Home & Garden</td>
                                                <td>65</td>
                                                <td>$1,299.35</td>
                                                <td>$19.99</td>
                                                <td>230</td>
                                            </tr>
                                            <tr>
                                                <td>Smart Watch</td>
                                                <td>Electronics</td>
                                                <td>42</td>
                                                <td>$6,288.60</td>
                                                <td>$149.73</td>
                                                <td>57</td>
                                            </tr>
                                            <tr>
                                                <td>Cotton T-Shirt</td>
                                                <td>Clothing</td>
                                                <td>38</td>
                                                <td>$758.62</td>
                                                <td>$19.96</td>
                                                <td>340</td>
                                            </tr>
                                            <tr>
                                                <td>Bluetooth Speaker</td>
                                                <td>Electronics</td>
                                                <td>35</td>
                                                <td>$2,447.65</td>
                                                <td>$69.93</td>
                                                <td>68</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="card mb-4">
                                    <div class="card-header">
                                        <h6 class="mb-0">Inventory Value by Category</h6>
                                    </div>
                                    <div class="card-body">
                                        <canvas id="inventoryValueChart" height="200"></canvas>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card mb-4">
                                    <div class="card-header">
                                        <h6 class="mb-0">Low Stock Products</h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="table-responsive">
                                            <table class="table table-sm">
                                                <thead>
                                                    <tr>
                                                        <th>Product</th>
                                                        <th>Current Stock</th>
                                                        <th>Min Stock</th>
                                                        <th>Status</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td>Smart Watch</td>
                                                        <td>8</td>
                                                        <td>10</td>
                                                        <td><span class="badge bg-warning">Low</span></td>
                                                    </tr>
                                                    <tr>
                                                        <td>Wireless Earbuds</td>
                                                        <td>5</td>
                                                        <td>15</td>
                                                        <td><span class="badge bg-danger">Critical</span></td>
                                                    </tr>
                                                    <tr>
                                                        <td>Laptop Bag</td>
                                                        <td>12</td>
                                                        <td>15</td>
                                                        <td><span class="badge bg-warning">Low</span></td>
                                                    </tr>
                                                    <tr>
                                                        <td>USB-C Cable</td>
                                                        <td>3</td>
                                                        <td>20</td>
                                                        <td><span class="badge bg-danger">Critical</span></td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Customers Reports Tab -->
                    <div class="tab-pane fade" id="customers" role="tabpanel" aria-labelledby="customers-tab">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <div class="input-group">
                                    <span class="input-group-text">Date Range</span>
                                    <input type="date" class="form-control" value="2025-03-01">
                                    <span class="input-group-text">to</span>
                                    <input type="date" class="form-control" value="2025-04-01">
                                    <button class="btn btn-primary" type="button">Apply</button>
                                </div>
                            </div>
                        </div>

                        <div class="row mb-4">
                            <div class="col-md-3">
                                <div class="card bg-primary text-white">
                                    <div class="card-body">
                                        <h6 class="card-title">Total Customers</h6>
                                        <h3 class="card-text">458</h3>
                                        <small class="text-white-50">+24 new this period</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card bg-success text-white">
                                    <div class="card-body">
                                        <h6 class="card-title">Returning Customers</h6>
                                        <h3 class="card-text">65%</h3>
                                        <small class="text-white-50">+3.2% from previous period</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card bg-info text-white">
                                    <div class="card-body">
                                        <h6 class="card-title">Customer Lifetime Value</h6>
                                        <h3 class="card-text">$342.56</h3>
                                        <small class="text-white-50">+5.1% from previous period</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card bg-warning text-white">
                                    <div class="card-body">
                                        <h6 class="card-title">Cart Abandonment</h6>
                                        <h3 class="card-text">23.4%</h3>
                                        <small class="text-white-50">-1.2% from previous period</small>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="card mb-4">
                                    <div class="card-header">
                                        <h6 class="mb-0">Customers by Location</h6>
                                    </div>
                                    <div class="card-body">
                                        <canvas id="customerLocationChart" height="200"></canvas>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card mb-4">
                                    <div class="card-header">
                                        <h6 class="mb-0">New vs Returning Customers</h6>
                                    </div>
                                    <div class="card-body">
                                        <canvas id="customerTypeChart" height="200"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <h6 class="mb-0">Top Customers</h6>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-striped table-hover">
                                        <thead>
                                            <tr>
                                                <th>Customer</th>
                                                <th>Orders</th>
                                                <th>Total Spent</th>
                                                <th>Avg. Order Value</th>
                                                <th>Last Purchase</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>John Smith</td>
                                                <td>12</td>
                                                <td>$1,254.38</td>
                                                <td>$104.53</td>
                                                <td>Mar 28, 2025</td>
                                            </tr>
                                            <tr>
                                                <td>Jane Doe</td>
                                                <td>9</td>
                                                <td>$952.45</td>
                                                <td>$105.83</td>
                                                <td>Mar 25, 2025</td>
                                            </tr>
                                            <tr>
                                                <td>Bob Johnson</td>
                                                <td>8</td>
                                                <td>$876.23</td>
                                                <td>$109.53</td>
                                                <td>Mar 22, 2025</td>
                                            </tr>
                                            <tr>
                                                <td>Sarah Williams</td>
                                                <td>7</td>
                                                <td>$742.91</td>
                                                <td>$106.13</td>
                                                <td>Mar 30, 2025</td>
                                            </tr>
                                            <tr>
                                                <td>Michael Brown</td>
                                                <td>6</td>
                                                <td>$634.58</td>
                                                <td>$105.76</td>
                                                <td>Mar 15, 2025</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Taxes Reports Tab -->
                    <div class="tab-pane fade" id="taxes" role="tabpanel" aria-labelledby="taxes-tab">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <div class="input-group">
                                    <span class="input-group-text">Date Range</span>
                                    <input type="date" class="form-control" value="2025-03-01">
                                    <span class="input-group-text">to</span>
                                    <input type="date" class="form-control" value="2025-04-01">
                                    <button class="btn btn-primary" type="button">Apply</button>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <select class="form-select">
                                    <option selected>All Tax Regions</option>
                                    <option>United States</option>
                                    <option>Europe</option>
                                    <option>Asia</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <select class="form-select">
                                    <option selected>All Tax Types</option>
                                    <option>Sales Tax</option>
                                    <option>VAT</option>
                                    <option>GST</option>
                                </select>
                            </div>
                        </div>

                        <div class="card mb-4">
                            <div class="card-header">
                                <h6 class="mb-0">Tax Summary</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="card bg-light mb-3">
                                            <div class="card-body text-center">
                                                <h6 class="card-title">Total Taxes Collected</h6>
                                                <h3 class="text-primary">$2,345.67</h3>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="card bg-light mb-3">
                                            <div class="card-body text-center">
                                                <h6 class="card-title">Taxable Sales</h6>
                                                <h3 class="text-primary">$22,456.89</h3>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="card bg-light mb-3">
                                            <div class="card-body text-center">
                                                <h6 class="card-title">Average Tax Rate</h6>
                                                <h3 class="text-primary">10.4%</h3>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="card mb-4">
                                    <div class="card-header">
                                        <h6 class="mb-0">Taxes by Region</h6>
                                    </div>
                                    <div class="card-body">
                                        <canvas id="taxRegionChart" height="200"></canvas>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card mb-4">
                                    <div class="card-header">
                                        <h6 class="mb-0">Tax Type Breakdown</h6>
                                    </div>
                                    <div class="card-body">
                                        <canvas id="taxTypeChart" height="200"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <h6 class="mb-0">Tax Detail Report</h6>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-striped table-hover">
                                        <thead>
                                            <tr>
                                                <th>Tax Authority</th>
                                                <th>Tax Type</th>
                                                <th>Taxable Sales</th>
                                                <th>Tax Rate</th>
                                                <th>Tax Collected</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>California</td>
                                                <td>Sales Tax</td>
                                                <td>$5,234.56</td>
                                                <td>8.25%</td>
                                                <td>$431.85</td>
                                            </tr>
                                            <tr>
                                                <td>New York</td>
                                                <td>Sales Tax</td>
                                                <td>$4,567.89</td>
                                                <td>8.875%</td>
                                                <td>$405.40</td>
                                            </tr>
                                            <tr>
                                                <td>Texas</td>
                                                <td>Sales Tax</td>
                                                <td>$3,876.54</td>
                                                <td>6.25%</td>
                                                <td>$242.28</td>
                                            </tr>
                                            <tr>
                                                <td>United Kingdom</td>
                                                <td>VAT</td>
                                                <td>$3,456.78</td>
                                                <td>20.00%</td>
                                                <td>$691.36</td>
                                            </tr>
                                            <tr>
                                                <td>Germany</td>
                                                <td>VAT</td>
                                                <td>$2,345.67</td>
                                                <td>19.00%</td>
                                                <td>$445.68</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Sample data for charts
        const ctx = document.getElementById('salesChart').getContext('2d');
        const salesChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
                datasets: [{
                    label: 'Sales',
                    data: [5250, 6420, 5840, 7072],
                    backgroundColor: 'rgba(13, 110, 253, 0.2)',
                    borderColor: 'rgba(13, 110, 253, 1)',
                    borderWidth: 2,
                    fill: true,
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return '$' + value;
                            }
                        }
                    }
                }
            }
        });

        // More charts would be initialized here if the DOM elements exist
        if (document.getElementById('paymentMethodChart')) {
            const paymentCtx = document.getElementById('paymentMethodChart').getContext('2d');
            const paymentChart = new Chart(paymentCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Credit Card', 'PayPal', 'Stripe', 'Other'],
                    datasets: [{
                        data: [12500, 5760, 4890, 1430],
                        backgroundColor: [
                            'rgba(13, 110, 253, 0.7)',
                            'rgba(25, 135, 84, 0.7)',
                            'rgba(13, 202, 240, 0.7)',
                            'rgba(255, 193, 7, 0.7)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }

        if (document.getElementById('categorySalesChart')) {
            const categoryCtx = document.getElementById('categorySalesChart').getContext('2d');
            const categoryChart = new Chart(categoryCtx, {
                type: 'bar',
                data: {
                    labels: ['Electronics', 'Clothing', 'Home & Garden', 'Accessories', 'Other'],
                    datasets: [{
                        label: 'Sales by Category',
                        data: [8560, 5240, 4780, 3250, 2750],
                        backgroundColor: 'rgba(13, 110, 253, 0.7)',
                        borderColor: 'rgba(13, 110, 253, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return '$' + value;
                                }
                            }
                        }
                    }
                }
            });
        }
    });
</script>
{% endblock %}
{% endblock %}